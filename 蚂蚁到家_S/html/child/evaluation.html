<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>评价</title>
		<link rel="stylesheet" type="text/css" href="../../css/base.css"/>
		<link rel="stylesheet" type="text/css" href="../../css/layout.css"/>
		<link rel="stylesheet" type="text/css" href="../../css/iconfont.css"/>
		<link rel="stylesheet" type="text/css" href="../../css/swiper-4.3.3.min.css"/>
		<link rel="stylesheet" type="text/css" href="css/evaluation.css"/>
		<script src="../../js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../js/ajaxs.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../js/swiper-4.3.3.min.js" type="text/javascript" charset="utf-8"></script>
	</head>
	<body>
		<header class="heads">
			<div>
				<div class="iconfont icon-guanbi lefts" onclick="window.history.go(-1);"></div>
				<div class="centers">评价</div>
			</div>
		</header>
		<section class="sets">
			<div class="rider">
				<div>
					<img src="" alt="" />
					<div>
						<div>周长远</div>
						<div>40分钟（13:20）送达</div>
					</div>
				</div>
				<div class="evaluation1">
					<div>配送评价</div>
					<div>
						<i class="iconfont icon-favourite"></i>
						<i class="iconfont icon-favourite"></i>
						<i class="iconfont icon-favourite"></i>
						<i class="iconfont icon-favourite"></i>
						<i class="iconfont icon-favourite"></i>
					</div>
					<div class="evaluation1_child1">
						<textarea placeholder="请对骑手做出评价"></textarea>
					</div>
				</div>
			</div>
			<div class="merchants">
				<div>
					<img src="" alt="" />
					<div>越来越喜便利店</div>
				</div>
				<div class="evaluation2">
					<div>配送评价</div>
					<div>
						<i class="iconfont icon-favourite"></i>
						<i class="iconfont icon-favourite"></i>
						<i class="iconfont icon-favourite"></i>
						<i class="iconfont icon-favourite"></i>
						<i class="iconfont icon-favourite"></i>
					</div>
					<div class="evaluation1_child2">
						<textarea placeholder="请对骑手做出评价"></textarea>
						<div class="images">
							<div>
								<input type="file" name='files' id="photo_child1" multiple accept="image/*"/>
								<label for="photo_child1" class="photo_child1">
									<div class="iconfont icon-tupian"></div>
									<div>添加图片</div>
					        	</label>
							</div>
							<!--<div class="images"></div>-->
						</div>
					</div>
				</div>
			</div>
		</section>
		<footer class="foots">
			<div>提交评价</div>
		</footer>
<script type="text/javascript">
	$(function(){
		funkr();//获取头部和底部的总高度
	
    	/*上传图片*/
        $("#photo_child1").change(function(){
        	var file = this.files[0];
        	var countFiles = $(this)[0].files.length;//获取选择的图片数量
        	var imgPath = $(this)[0].value;//获取选中的图片
        	var extn = imgPath.substring(imgPath.lastIndexOf('.') + 1).toLowerCase();
        	//获取图片的大小
        	var size = this.files[0].size / 1024;
        	var image_holder = $(".images>div");
		   	if (extn == "gif" || extn == "png" || extn == "jpg" || extn == "jpeg") {
		   	    if (typeof (FileReader) != "undefined") {
		        	if(size > 1024*2){
		        		alert('图片大小不能超过2M');
		        		return false;
		        	}else{
			   	        // 循环所有要上传的图片
			   	        for (var i = 0; i < countFiles; i++) {
			   	            var reader = new FileReader();
			   	            reader.onload = function (e) {
			   	            	image_holder.after($(`<img src=${e.target.result} class="images_child">`));
			   	            	
			   	            }
			   	            reader.readAsDataURL($(this)[0].files[i]);
			   	        }	
		        	}
		   	    } else {
		   	        alert("你的浏览器不支持FileReader！");
		   	    }
		   	} else {
		   	    alert("请选择图像文件。");
		   	}
        })
		function getObjectURL(file) {  
		    var url = null;  
		    if(window.createObjcectURL != undefined) {  
		        url = window.createOjcectURL(file);  
		    }else if (window.URL != undefined) {  
		        url = window.URL.createObjectURL(file);  
		    }else if(window.webkitURL != undefined) {  
		        url = window.webkitURL.createObjectURL(file);  
		    }  
		    return url;  
		}
		$(".images").on("click",".images_child",function(){
			$(this).remove();
		})
		$(".evaluation1 i").click(function(){
			var aa=$(this).index()+1;
			var bb=$(this).index();
			console.log(aa);
			funk(aa,bb,$(".evaluation1"));
		})
		$(".evaluation2 i").click(function(){
			var aa=$(this).index()+1;
			var bb=$(this).index();
			funk(aa,bb,$(".evaluation2"));
		})
		function funk(aa,bb,address){
			address.find("i").css("color","#333333");
			if(aa<=2){
				cssd();
				address.find(".icon-shoucang").css({"color":"#dddddd"});
			}else if(aa>2&&aa<=4){
				cssd();
				address.find(".icon-shoucang").css({"color":"rgba(250,105,57,0.5)"});
			}else{
				cssd();
				address.find(".icon-shoucang").css({"color":"#fa6939"});
			}
			function cssd(){
				address.find("i:lt("+aa+")").removeClass("icon-favourite");
				address.find("i:lt("+aa+")").addClass("icon-shoucang");
				address.find("i:gt("+bb+")").removeClass("icon-shoucang");
				address.find("i:gt("+bb+")").addClass("icon-favourite");
			}
		}
	})
</script>
	</body>
</html>
